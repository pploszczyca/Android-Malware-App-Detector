from abc import ABC, abstractmethod

from sklearn.metrics import accuracy_score, confusion_matrix, classification_report


class Classifier(ABC):
    def __init__(self, training_data, test_data, name):
        self.name = name
        self.X_train = training_data.drop('Label', axis=1)
        self.y_train = training_data['Label']
        self.X_test = test_data.drop('Label', axis=1)
        self.y_test = test_data['Label']
        self.model = None

    @abstractmethod
    def train_and_evaluate(self):
        pass

    def print_normal_statistics(self):
        self.__print_statistics(self.X_test, self.y_test)

    def __print_statistics(self, x_data, y_data):
        predictions = self.model.predict(x_data)
        accuracy = accuracy_score(y_data, predictions)
        confusion = confusion_matrix(y_data, predictions)
        report = classification_report(y_data, predictions)

        print(f"Classifier: {self.name}")
        print(f"Accuracy: {accuracy}")
        print(f"Confusion Matrix:\n{confusion}")
        print(f"Classification Report:\n{report}")

        print("\n")
